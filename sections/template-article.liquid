<article class="py-8" itemscope itemtype="https://schema.org/BlogPosting">
  {% for block in section.blocks %}
    {% case block.type %}
      {% when 'title' %}
          <div class="flex items-center justify-center">
               <div class="max-w-7xl text-center">
                    <a href="{{ blog.url }}" class="text-base uppercase text-gray-500 hover:text-gray-900 font-bold">{{ blog.title }}</a>
                    <h1 class="text-4xl md:text-6xl font-medium" itemprop="headline">{{ article.title }}</h1>
               </div>
          </div>

      {% when 'content' %}
          <div class="flex items-center justify-center">
               <div class="max-w-4xl" itemprop="articleBody">
                    {{ article.content }}
               </div>
          </div>

      {% when 'featured_image' %}
          <div class="max-w-7xl bg-blue-100 rounded-lg mx-2 md:mx-auto overflow-hidden my-4">

        {% if article.image %}
          
          <img src="{{ article.image | image_url: width: 1200 }}" alt="{{ article.image.alt | escape }}" class="w-full h-80 md:h-96 object-cover object-center" />
            {% else %}
               <img src="https://placehold.co/1200x600?text=No+Image" alt="No image available" class="w-full h-80 md:h-96 object-cover object-center"/>

        {% endif %}
        </div>

      {% when 'author' %}
          <div class="flex items-center justify-center">
               <div class="max-w-7xl text-center" itemprop="author" itemscope itemtype="https://schema.org/Person">
                    {% if section.settings.display_author_details %}
                         <small itemprop="name">By {{ article.author }}</small>
                    {% endif %}
               </div>
          </div>

      {% when 'date' %}
          <div class="flex items-center justify-center">
               <div class="max-w-7xl text-center">
                    {% if section.settings.display_date %}
                         <time datetime="{{ article.published_at | date: '%Y-%m-%d' }}">{{ article.published_at | date: "%B %d, %Y" }}</time>
                    {% endif %}
               </div>
          </div>
    {% endcase %}
  {% endfor %}

  {% if article.comments_enabled? %}

     {% if article.comments_count > 0 %}
     <div class="max-w-3xl mx-auto mt-10">
     <h2 class="text-2xl font-bold mb-6">Comments ({{ article.comments_count }})</h2>

     {% paginate article.comments by 5 %}
          <div class="space-y-6">
          {% for comment in article.comments %}
               <div class="border-b border-gray-200 pb-4">
               <p class="text-gray-800 mb-2">{{ comment.content }}</p>
               <div class="text-sm text-gray-500">
               <span>By {{ comment.author }}</span> 
               <span class="mx-2">•</span>
               <time>{{ comment.created_at | date: "%B %d, %Y" }}</time>
               </div>
               </div>
          {% endfor %}
          </div>

          <!-- Pagination -->
          {% if paginate.pages > 1 %}
          <div class="flex justify-between items-center mt-6">
               {% if paginate.previous %}
               <a href="{{ paginate.previous.url }}" class="px-4 py-2 border rounded-lg text-sm text-gray-600 hover:bg-gray-100">
               ← Previous
               </a>
               {% else %}
               <span class="px-4 py-2 text-sm text-gray-400">← Previous</span>
               {% endif %}

               <span class="text-sm text-gray-500">Page {{ paginate.current_page }} of {{ paginate.pages }}</span>

               {% if paginate.next %}
               <a href="{{ paginate.next.url }}" class="px-4 py-2 border rounded-lg text-sm text-gray-600 hover:bg-gray-100">
               Next →
               </a>
               {% else %}
               <span class="px-4 py-2 text-sm text-gray-400">Next →</span>
               {% endif %}
          </div>
          {% endif %}
     {% endpaginate %}
     </div>
     {% endif %}

     <div class="max-w-3xl mx-auto mt-10">
          <h2 class="text-2xl font-bold mb-4">Leave a Comment</h2>

     {% form 'new_comment', article, class: 'space-y-4' %}
          {{ form.errors | default_errors }}
          {% if form.posted_successfully? %}
               <p class="text-green-600">Thank you for your comment!</p>
          {% endif %}
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
               <input 
               type="text" 
               name="comment[author]" 
               id="CommentAuthor" 
               value="{{ form.author }}" 
               placeholder="Your name"
               class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"
               required
               >
               <input 
               type="email" 
               name="comment[email]" 
               id="CommentEmail" 
               value="{{ form.email }}" 
               placeholder="Your email"
               class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"
               required
               >
          </div>
          <textarea 
          name="comment[body]" 
          id="CommentBody" 
          rows="5" 
          placeholder="Your comment"
          class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"
          required
          ></textarea>

          <button 
          type="submit" 
          class="bg-indigo-600 text-white font-semibold px-6 py-2 rounded-lg shadow hover:bg-indigo-700 transition"
          >
          Post Comment
          </button>
     {% endform %}
     </div>
  {% endif %}
</article>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": {{ article.title | json }},
  "description": {{ article.excerpt_or_content | strip_html | truncate: 160 | json }},
  "articleBody": {{ article.content | strip_html | json }},
  {% if article.image %}
    "image": [{{ article.image | image_url: width: 1200 | prepend: shop.url | json }}],
  {% else %}
    "image": [{{ 'placeholder-image.png' | asset_url | prepend: shop.url | json }}],
  {% endif %}
  "author": {
    "@type": "Person",
    "name": {{ article.author | json }}
  },
  "dateCreated": "{{ article.created_at | default }}",
  "datePublished": "{{ article.published_at | default }}",
  "dateModified": "{{ article.updated_at | default }}",
  "publisher": {
    "@type": "Organization",
    "name": {{ shop.name | json }}
    {% if settings.logo %}
      "logo": {
        "@type": "ImageObject",
        "url": {{ settings.logo | image_url: width: 600 | prepend: shop.url | json }}
      }
    {% endif %}
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": {{ article.url | prepend: shop.url | json }}
  }
}
</script>



{% schema %}
     {
     "name": "Article template",
     "settings": [
          {
               "type": "checkbox",
               "id": "display_author_details",
               "label": "Display author details",
               "default": true
          },
          {
               "type": "checkbox",
               "id": "display_date",
               "label": "Display article date",
               "default": true
          }
     ],
     "blocks": [
          {
          "type": "title",
          "name": "Title"
          },
          {
          "type": "content",
          "name": "Content"
          },
          {
          "type": "featured_image",
          "name": "Featured image"
          },
          {
          "type": "author",
          "name": "Author"
          },
          {
          "type": "date",
          "name": "Date"
          }
     ]
     
     
     }
{% endschema %}